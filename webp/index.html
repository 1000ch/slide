<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>WebP</title>
    <link rel="stylesheet" href="../bower_components/reveal.js/css/reveal.min.css">
    <link rel="stylesheet" href="../bower_components/reveal.js/css/theme/simple.css">
    <script src="../bower_components/reveal.js/js/reveal.min.js"></script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <h1>WebP is Future</h1>
          <h3>Shogo Sensui</h3>
        </section>
        <section>
          <section>
            <h1>WebP使おうぜ！</h1>
          </section>
          <section>
            <h2>WebPって何？</h2>
            <ul>
              <li>「ウェッピー」と読む</li>
              <li>Googleが開発した新しい画像フォーマット</li>
              <li>圧縮効率がよく、ファイルサイズがとても小さい</li>
            </ul>
          </section>
          <section>
            <h2>どのくらい小さいの？</h2>
          </section>
          <section>
            <h2>各種フォーマット比</h2>
            <ul>
              <li>PNG8と同じくらい</li>
              <li>同程度の画像品質でJPGの平均30%オフ</li>
            </ul>
          </section>
          <section>
            <h2>サービスが提供するリソースのうち画像の占める割合</h2>
          </section>
          <section>
            <h2>ガールフレンド（仮）の場合</h2>
            <img src="capture.png">
          </section>
          <section>
            <h2>ダウンロードさせるリソースの大半を画像が占めている</h2>
            <p>弊社ゲームサービスにおいては、特に顕著（平均70%~80%）</p>
          </section>
          <section>
            <h2>YouTube等では既に使われてる</h2>
            <p><a href='https://www.youtube.com/watch?v=8vJSCmIMIjI'>ビデオサムネイルのサイズを20%削減し、ページロードを10%高速化した。</a></p>
          </section>
          <section>
            <h1>Performance is Feature</h1>
            <h3>スピードに勝るユーザー体験は無い</h3>
          </section>
        </section>
        <section>
          <section>
            <h1>実現可能性</h1>
          </section>
          <section>
            <h2>デバイスのWebP対応状況</h2>
            <ul>
              <li>✘ iPhone Safari</li>
              <li>✔ iPhone Chrome</li>
              <li>✘ Android ベンダーブラウザ</li>
              <li>✔ Android Chrome</li>
            </ul>
          </section>
          <section>
            <h2>対応状況あまり良くない</h2>
            <p>けど今回は、あまり重要じゃない</p>
          </section>
          <section>
            <h2>iPhoneのChromeでOKということは…</h2>
          </section>
          <section>
            <h2>iPhoneでもWebP表示可能</h2>
            <p>iOS SDKのWebViewにもWebPデコーダを組み込める</p>
          </section>
          <section>
            <h1>つまり…</h1>
          </section>
          <section>
            <h2>ガワアプリでWebPで軽量化された画像リソースを使える</h2>
            <p>ストアのアプリが高速に動作すれば良い副作用が連鎖的にありそう</p>
          </section>
        </section>
        <section>
          <section>
            <h1>開発側でやること</h1>
          </section>
          <section>
            <h2>WebP画像の用意</h2>
            <p>今までのPNG・JPGの画像で、WebPにコンバートしたものも用意する。</p>
            <p>これについてはツールで自動化する（デザイナーが意識しないように）。</p>
          </section>
          <section>
            <h2>配信サーバーの設定</h2>
            <pre><code>location = /hoge {
    if ($http_accept ~* "webp") {
        add_header Vary Accept;
        rewrite (.*) $1.webp last;
    }
    if ($http_user_agent ~* "(Chrome|Opera|Android|Android.*Chrome)") {
        add_header Vary User-Agent;
        rewrite (.*) $1.webp last;
    }
    rewrite (.*) $1.png last;
}</code></pre>
            <p>これはNginxの例</p>
          </section>
          <section>
            <h2>リクエストヘッダのacceptにimage/webpを含める</h2>
            <p>WebPに対応しているブラウザであれば勝手に投げる</p>
            <p>ガワアプリのWebViewの仕組みは要調査</p>
          </section>
          <section>
            <h1>たったこれだけ</h1>
          </section>
        </section>
        <section>
          <section>
            <h1>作ったツール<h1>
          </section>
          <section>
            <h2>あまりツール化されていない</h2>
            <p>ビルドとかいちいち面倒だし、自動化できないと現実解にならない</p>
          </section>
          <section>
            <h2>エンコーダ系</h2>
            <ul>
              <li><a href='http://github.com/1000ch/node-cwebp-bin'>node-cwebp-bin</a> - エンコーダ（cwebp）のnodeラッパー</li>
              <li><a href='http://github.com/1000ch/grunt-cwebp'>grunt-cwebp</a> - gruntモジュール</li>
              <li><a href='http://github.com/1000ch/gulp-cwebp'>gulp-cwebp</a> - gulpモジュール</li>
            </ul>
          </section>
          <section>
            <h2>デコーダ系</h2>
            <ul>
              <li><a href='http://github.com/1000ch/node-dwebp-bin'>node-dwebp-bin</a> - デコーダ（dwebp）のnodeラッパー</li>
              <li><a href='http://github.com/1000ch/grunt-dwebp'>grunt-dwebp</a> - gruntモジュール</li>
              <li><a href='http://github.com/1000ch/gulp-dwebp'>gulp-dwebp</a> - gulpモジュール</li>
            </ul>
          </section>
        </section>
        <section>
          <h1>おしまい</h1>
        </section>
      </div>
    </div>
    <script>
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: false,
        width: 1280
      });
    </script>
  </body>
</html>